{{!-- FilterPanel Component Template --}}
<div
  class="filter-panel card ofinder-shadow ofinder-rounded p-4"
  ...attributes
>
  {{!-- Header cliccabile su mobile --}}
  <div
    class="filter-panel-header d-flex justify-content-between align-items-center mb-0 pb-0"
  >
    <h5 class="ofinder-heading-md ofinder-filter-panel-title mb-0">FILTRI</h5>

    <div class="d-flex align-items-center" style="pointer-events: auto;">
      {{#if this.hasActiveFilters}}
        <button
          type="button"
          class="btn btn-link btn-sm ofinder-text-primary p-0 mr-3 d-none d-md-inline"
          style="position: relative; z-index: 10; cursor: pointer; pointer-events: auto;"
          {{on "click" this.clearAllFilters capture=false}}
        >
          Cancella tutto
        </button>
      {{/if}}
      <i
        class="fa fa-chevron-down d-md-none"
        style="cursor: pointer;"
        data-toggle="collapse"
        data-target="#filterPanelContent"
        role="button"
        aria-expanded="false"
        aria-controls="filterPanelContent"
      ></i>
    </div>
  </div>

  {{!-- Contenuto collassabile (solo su mobile) --}}
  <div id="filterPanelContent" class="collapse d-md-block">
    <hr class="d-md-none my-3" />

    {{!-- Accordion container per sezioni interne --}}
    <div id="filterAccordion">
      {{!-- Cosa cerchi? (Tipo di ricerca) - FILTRO PRINCIPALE --}}
      <div class="filter-section ofinder-filter-section-primary mb-4">
        <h6
          class="ofinder-text-sm ofinder-filter-section-heading-primary font-weight-bold mb-3 text-uppercase d-flex justify-content-between align-items-center"
        >
          <span>
            Cosa cerchi?
            {{#if this.selectedSearchTypeLabel}}
              <span
                class="ofinder-text-primary"
                style="cursor: pointer;"
                {{on "click" this.clearSearchType}}
                role="button"
              >
                {{this.selectedSearchTypeLabel}}
                <i class="fa fa-times ml-1"></i>
              </span>
            {{/if}}
          </span>
          <i
            class="fa fa-chevron-down d-md-none"
            style="cursor: pointer;"
            data-toggle="collapse"
            data-target="#collapseSearchType"
            role="button"
            aria-expanded="true"
            aria-controls="collapseSearchType"
          ></i>
        </h6>
        <div id="collapseSearchType" class="collapse show d-md-block" data-parent="#filterAccordion">
          {{#each this.searchTypes as |searchType|}}
            <div class="custom-control custom-radio mb-2">
              <input
                type="radio"
                class="custom-control-input"
                id="searchType-{{searchType.id}}"
                name="searchTypeFilter"
                checked={{eq this.searchType searchType.id}}
                {{on "change" (fn this.selectSearchType searchType.id)}}
              />
              <label
                class="custom-control-label ofinder-text-sm ofinder-search-type-label"
                for="searchType-{{searchType.id}}"
              >
                {{searchType.label}}
              </label>
            </div>
          {{/each}}
        </div>
      </div>

      {{!-- Mostra i filtri seguenti solo se è stato selezionato un tipo di ricerca --}}
      {{#if this.searchType}}

      {{!-- Geolocalizzazione --}}
      <div class="filter-section mb-3">
        <h6
          class="ofinder-text-sm font-weight-bold mb-3 text-uppercase d-flex justify-content-between align-items-center"
        >
          <span>
            Posizione
            {{#if this.locationLabel}}
              <span
                class="ofinder-text-primary"
                style="cursor: pointer;"
                {{on "click" this.clearLocation}}
                role="button"
              >
                {{this.locationLabel}}
                <i class="fa fa-times ml-1"></i>
              </span>
            {{/if}}
          </span>
          <i
            class="fa fa-chevron-down"
            style="cursor: pointer;"
            data-toggle="collapse"
            data-target="#collapseLocation"
            role="button"
            aria-expanded="true"
            aria-controls="collapseLocation"
          ></i>
        </h6>
        <div id="collapseLocation" class="collapse show" data-parent="#filterAccordion">
          {{!-- Regione --}}
          <div class="form-group mb-3">
            <label class="ofinder-text-xs text-uppercase ofinder-text-muted mb-1">
              Regione
            </label>
            <Standard::SelectTwo
              @addEmptyOption="1"
              @options={{this.regionsOptions}}
              @changeCB={{this.onRegionChange}}
            />
          </div>

          {{!-- Provincia --}}
          <div class="form-group mb-0">
            <label class="ofinder-text-xs text-uppercase ofinder-text-muted mb-1">
              Provincia
            </label>
            <Standard::SelectTwo
              @addEmptyOption="1"
              @options={{this.provincesOptions}}
              @changeCB={{this.onProvinceChange}}
              disabled={{unless this.selectedRegionId true}}
            />
          </div>
        </div>
      </div>

      {{!-- Età --}}
      <div class="filter-section mb-3">
        <h6
          class="ofinder-text-sm font-weight-bold mb-3 text-uppercase d-flex justify-content-between align-items-center"
        >
          <span>
            Età
            <span class="ofinder-text-primary">{{this.minAge}}-{{this.maxAge}}</span>
          </span>
          <i
            class="fa fa-chevron-down"
            style="cursor: pointer;"
            data-toggle="collapse"
            data-target="#collapseAge"
            role="button"
            aria-expanded="false"
            aria-controls="collapseAge"
          ></i>
        </h6>
        <div id="collapseAge" class="collapse" data-parent="#filterAccordion">
          {{!-- Età minima --}}
          <div class="mb-3">
            <label class="ofinder-text-xs text-uppercase ofinder-text-muted mb-1">
              Età minima: {{this.minAge}}
            </label>
            <input
              type="range"
              class="custom-range"
              min="18"
              max="60"
              step="1"
              value={{this.minAge}}
              {{on "input" this.updateMinAge}}
            />
          </div>

          {{!-- Età massima --}}
          <div class="mb-0">
            <label class="ofinder-text-xs text-uppercase ofinder-text-muted mb-1">
              Età massima: {{this.maxAge}}
            </label>
            <input
              type="range"
              class="custom-range"
              min="18"
              max="60"
              step="1"
              value={{this.maxAge}}
              {{on "input" this.updateMaxAge}}
            />
          </div>
        </div>
      </div>

      {{!-- Orari Live (per CamGirl e Performer con live) --}}
      {{#if this.showScheduleFilter}}
      <div class="filter-section mb-3">
        <h6
          class="ofinder-text-sm font-weight-bold mb-3 text-uppercase d-flex justify-content-between align-items-center"
        >
          <span>
            Orari Live
            {{#if this.scheduleSummaryLabel}}
              <span
                class="ofinder-text-primary"
                style="cursor: pointer;"
                {{on "click" this.clearSchedule}}
                role="button"
              >
                {{this.scheduleSummaryLabel}}
                <i class="fa fa-times ml-1"></i>
              </span>
            {{/if}}
          </span>
          <i
            class="fa fa-chevron-down"
            style="cursor: pointer;"
            data-toggle="collapse"
            data-target="#collapseSchedule"
            role="button"
            aria-expanded="false"
            aria-controls="collapseSchedule"
          ></i>
        </h6>
        <div id="collapseSchedule" class="collapse" data-parent="#filterAccordion">
          {{!-- Giorni della settimana --}}
          <div class="mb-3">
            <label class="ofinder-text-xs text-uppercase ofinder-text-muted mb-2">
              Giorno
            </label>
            <div class="btn-group btn-group-toggle d-flex flex-wrap" data-toggle="buttons">
              {{#each this.weekDays as |day|}}
                <label class="btn btn-sm {{if (this.isScheduleDaySelected day.id) 'btn-ofinder-primary active' 'btn-outline-secondary'}}">
                  <input
                    type="radio"
                    name="scheduleDayFilter"
                    id="scheduleDay-{{day.id}}"
                    checked={{this.isScheduleDaySelected day.id}}
                    {{on "change" (fn this.selectScheduleDay day.id)}}
                  />
                  {{day.shortName}}
                </label>
              {{/each}}
            </div>
          </div>

          {{!-- Fascia oraria --}}
          <div class="mb-0">
            <label class="ofinder-text-xs text-uppercase ofinder-text-muted mb-2">
              Fascia oraria
              {{#if this.selectedTimeSlotLabel}}
                <span class="ofinder-text-primary ml-2">{{this.selectedTimeSlotLabel}}</span>
              {{/if}}
            </label>
            <div class="btn-group btn-group-toggle w-100" data-toggle="buttons">
              {{#each this.timeSlots as |slot|}}
                <label class="btn btn-sm {{if (this.isTimeSlotSelected slot.id) 'btn-ofinder-primary active' 'btn-outline-secondary'}}">
                  <input
                    type="radio"
                    name="timeSlotFilter"
                    id="timeSlot-{{slot.id}}"
                    checked={{this.isTimeSlotSelected slot.id}}
                    {{on "change" (fn this.selectTimeSlot slot.id)}}
                  />
                  {{slot.shortLabel}}
                </label>
              {{/each}}
            </div>
          </div>
        </div>
      </div>
      {{/if}}

      {{!-- Piattaforme (solo per Performer) --}}
      {{#if this.showPlatformsFilter}}
      <div class="filter-section mb-3">
        <h6
          class="ofinder-text-sm font-weight-bold mb-3 text-uppercase d-flex justify-content-between align-items-center"
        >
          <span>
            Piattaforme
            {{#if (gt this.selectedPlatformsCount 0)}}
              <span
                class="ofinder-text-primary"
                style="cursor: pointer;"
                {{on "click" this.clearPlatforms}}
                role="button"
              >
                ({{this.selectedPlatformsCount}})
                <i class="fa fa-times ml-1"></i>
              </span>
            {{/if}}
          </span>
          <i
            class="fa fa-chevron-down"
            style="cursor: pointer;"
            data-toggle="collapse"
            data-target="#collapsePlatforms"
            role="button"
            aria-expanded="false"
            aria-controls="collapsePlatforms"
          ></i>
        </h6>
        <div id="collapsePlatforms" class="collapse" data-parent="#filterAccordion">
          {{#each this.platformFilters as |platform|}}
            <div class="custom-control custom-checkbox mb-2">
              <input
                type="checkbox"
                class="custom-control-input"
                id="platform-{{platform.id}}"
                checked={{this.isPlatformSelected platform.id}}
                {{on "change" (fn this.togglePlatform platform)}}
              />
              <label
                class="custom-control-label ofinder-text-sm"
                for="platform-{{platform.id}}"
              >
                <span class="platform-icon-badge mr-2">{{brand-icon platform.id size=14}}</span>
                {{platform.name}}
                <span class="ofinder-text-muted">({{platform.count}})</span>
              </label>
            </div>
          {{/each}}
        </div>
      </div>
      {{/if}}

      {{!-- Tipi di Contenuto Performer (solo per Performer) --}}
      {{#if this.showPerformerContentTypesFilter}}
      <div class="filter-section mb-3">
        <h6
          class="ofinder-text-sm font-weight-bold mb-3 text-uppercase d-flex justify-content-between align-items-center"
        >
          <span>
            Tipi di Contenuto
            {{#if (gt this.selectedPerformerContentTypesCount 0)}}
              <span
                class="ofinder-text-primary"
                style="cursor: pointer;"
                {{on "click" this.clearPerformerContentTypes}}
                role="button"
              >
                ({{this.selectedPerformerContentTypesCount}})
                <i class="fa fa-times ml-1"></i>
              </span>
            {{/if}}
          </span>
          <i
            class="fa fa-chevron-down"
            style="cursor: pointer;"
            data-toggle="collapse"
            data-target="#collapsePerformerContentTypes"
            role="button"
            aria-expanded="false"
            aria-controls="collapsePerformerContentTypes"
          ></i>
        </h6>
        <div id="collapsePerformerContentTypes" class="collapse" data-parent="#filterAccordion">
          {{#each this.performerContentTypesByCategory as |categoryGroup|}}
            <div class="content-type-category mb-3">
              <h6 class="content-type-category-title ofinder-text-xs text-uppercase mb-2">
                {{categoryGroup.name}}
              </h6>
              <div class="filter-section-two-columns">
                {{#each categoryGroup.items as |contentType|}}
                  <div class="custom-control custom-checkbox">
                    <input
                      type="checkbox"
                      class="custom-control-input"
                      id="performerContentType-{{contentType.id}}"
                      checked={{this.isContentTypeSelected contentType.id}}
                      {{on "change" (fn this.toggleContentType contentType)}}
                    />
                    <label
                      class="custom-control-label ofinder-text-sm"
                      for="performerContentType-{{contentType.id}}"
                    >
                      {{contentType.name}}
                      {{#if contentType.tooltip}}
                        <Standard::ToolTip @title={{contentType.tooltip}}>
                          <i class="fa fa-question-circle content-type-help-icon ml-1"></i>
                        </Standard::ToolTip>
                      {{/if}}
                    </label>
                  </div>
                {{/each}}
              </div>
            </div>
          {{/each}}
        </div>
      </div>
      {{/if}}

      {{!-- Tipi di Show Live (per CamGirl sempre, per Performer solo se selezionato live-public o live-private) --}}
      {{#if this.showLiveShowTypesFilter}}
      <div class="filter-section mb-3">
        <h6
          class="ofinder-text-sm font-weight-bold mb-3 text-uppercase d-flex justify-content-between align-items-center"
        >
          <span>
            Tipi di Show Live
            {{#if (gt this.selectedLiveShowTypesCount 0)}}
              <span
                class="ofinder-text-primary"
                style="cursor: pointer;"
                {{on "click" this.clearLiveShowTypes}}
                role="button"
              >
                ({{this.selectedLiveShowTypesCount}})
                <i class="fa fa-times ml-1"></i>
              </span>
            {{/if}}
          </span>
          <i
            class="fa fa-chevron-down"
            style="cursor: pointer;"
            data-toggle="collapse"
            data-target="#collapseLiveShowTypes"
            role="button"
            aria-expanded="false"
            aria-controls="collapseLiveShowTypes"
          ></i>
        </h6>
        <div id="collapseLiveShowTypes" class="collapse" data-parent="#filterAccordion">
          {{#each this.liveShowTypesByCategory as |categoryGroup|}}
            <div class="content-type-category mb-3">
              <h6 class="content-type-category-title ofinder-text-xs text-uppercase mb-2">
                {{categoryGroup.name}}
              </h6>
              <div class="filter-section-two-columns">
                {{#each categoryGroup.items as |contentType|}}
                  <div class="custom-control custom-checkbox">
                    <input
                      type="checkbox"
                      class="custom-control-input"
                      id="liveShowType-{{contentType.id}}"
                      checked={{this.isContentTypeSelected contentType.id}}
                      {{on "change" (fn this.toggleContentType contentType)}}
                    />
                    <label
                      class="custom-control-label ofinder-text-sm"
                      for="liveShowType-{{contentType.id}}"
                    >
                      {{contentType.name}}
                      {{#if contentType.tooltip}}
                        <Standard::ToolTip @title={{contentType.tooltip}}>
                          <i class="fa fa-question-circle content-type-help-icon ml-1"></i>
                        </Standard::ToolTip>
                      {{/if}}
                    </label>
                  </div>
                {{/each}}
              </div>
            </div>
          {{/each}}
        </div>
      </div>
      {{/if}}

      {{!-- Range Slider Prezzo --}}
      <div class="filter-section mb-3">
        <h6
          class="ofinder-text-sm font-weight-bold mb-3 text-uppercase d-flex justify-content-between align-items-center"
        >
          <span>
            {{this.priceLabel}}
            <span class="ofinder-text-primary">€{{this.maxPrice}}</span>
          </span>
          <i
            class="fa fa-chevron-down"
            style="cursor: pointer;"
            data-toggle="collapse"
            data-target="#collapsePrice"
            role="button"
            aria-expanded="false"
            aria-controls="collapsePrice"
          ></i>
        </h6>
        <div id="collapsePrice" class="collapse" data-parent="#filterAccordion">
          <input
            type="range"
            class="custom-range"
            min="0"
            max="50"
            step="5"
            value={{this.maxPrice}}
            {{on "input" this.updatePriceFilter}}
          />
          <div
            class="d-flex justify-content-between ofinder-text-xs ofinder-text-muted mt-2"
          >
            <span>Free</span>
            <span>€50+</span>
          </div>
        </div>
      </div>

      {{!-- Rating --}}
      <div class="filter-section mb-3">
        <h6
          class="ofinder-text-sm font-weight-bold mb-3 text-uppercase d-flex justify-content-between align-items-center"
        >
          <span>
            Voto minimo
            {{#if this.selectedRatingLabel}}
              <span
                class="ofinder-text-primary"
                style="cursor: pointer;"
                {{on "click" this.clearRating}}
                role="button"
              >
                {{this.selectedRatingLabel}}
                <i class="fa fa-times ml-1"></i>
              </span>
            {{/if}}
          </span>
          <i
            class="fa fa-chevron-down"
            style="cursor: pointer;"
            data-toggle="collapse"
            data-target="#collapseRating"
            role="button"
            aria-expanded="false"
            aria-controls="collapseRating"
          ></i>
        </h6>
        <div id="collapseRating" class="collapse" data-parent="#filterAccordion">
          {{#each this.ratingFilters as |rating|}}
            <div class="custom-control custom-radio mb-2">
              <input
                type="radio"
                class="custom-control-input"
                id="rating-{{rating.value}}"
                name="ratingFilter"
                checked={{eq this.selectedRating rating.value}}
                {{on "change" (fn this.selectRating rating.value)}}
              />
              <label
                class="custom-control-label ofinder-text-sm"
                for="rating-{{rating.value}}"
              >
                <RatingStars @rating={{rating.value}} @size="sm" />
                ({{rating.label}})
              </label>
            </div>
          {{/each}}
        </div>
      </div>

      {{!-- Stato --}}
      <div class="filter-section mb-3">
        <h6
          class="ofinder-text-sm font-weight-bold mb-3 text-uppercase d-flex justify-content-between align-items-center"
        >
          <span>
            Stato
            {{#if this.selectedStatusLabel}}
              <span
                class="ofinder-text-primary"
                style="cursor: pointer;"
                {{on "click" this.clearStatus}}
                role="button"
              >
                {{this.selectedStatusLabel}}
                <i class="fa fa-times ml-1"></i>
              </span>
            {{/if}}
          </span>
          <i
            class="fa fa-chevron-down"
            style="cursor: pointer;"
            data-toggle="collapse"
            data-target="#collapseStatus"
            role="button"
            aria-expanded="false"
            aria-controls="collapseStatus"
          ></i>
        </h6>
        <div id="collapseStatus" class="collapse" data-parent="#filterAccordion">
          <div class="custom-control custom-checkbox mb-2">
            <input
              type="checkbox"
              class="custom-control-input"
              id="filter-verified"
              checked={{this.onlyVerified}}
              {{on "change" this.toggleVerified}}
            />
            <label class="custom-control-label ofinder-text-sm" for="filter-verified">
              <span class="ofinder-badge-verified ofinder-rounded-sm">✓</span>
              Solo Verificati
            </label>
          </div>

          <div class="custom-control custom-checkbox mb-2">
            <input
              type="checkbox"
              class="custom-control-input"
              id="filter-new"
              checked={{this.onlyNew}}
              {{on "change" this.toggleNew}}
            />
            <label class="custom-control-label ofinder-text-sm" for="filter-new">
              <span class="ofinder-badge-new ofinder-rounded-sm">New</span>
              Nuovi (ultimi 30gg)
            </label>
          </div>
        </div>
      </div>

      {{!-- Fine condizione: mostra filtri solo se searchType è selezionato --}}
      {{/if}}

    </div>

    {{!-- Bottoni Azione --}}
    <div class="filter-panel-footer mt-4">
      <button
        type="button"
        class="btn btn-block btn-ofinder-primary mb-2"
        {{on "click" this.applyFilters}}
      >
        Applica Filtri
        {{#if this.activeFiltersCount}}
          ({{this.activeFiltersCount}})
        {{/if}}
      </button>

      {{#if this.hasActiveFilters}}
        <button
          type="button"
          class="btn btn-block btn-outline-secondary"
          {{on "click" this.clearAllFilters}}
        >
          Cancella tutto
        </button>
      {{/if}}
    </div>
  </div>
</div>

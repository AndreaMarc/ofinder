{{!-- FilterPanel Component Template --}}
<div
  class="filter-panel card ofinder-shadow ofinder-rounded p-4"
  ...attributes
>
  {{!-- Header cliccabile su mobile --}}
  <div
    class="filter-panel-header d-flex justify-content-between align-items-center mb-0 pb-0"
    data-toggle="collapse"
    data-target="#filterPanelContent"
    role="button"
    aria-expanded="false"
    aria-controls="filterPanelContent"
  >
    <h5 class="ofinder-heading-md mb-0">Filtri</h5>

    <div class="d-flex align-items-center">
      {{#if this.hasActiveFilters}}
        <button
          type="button"
          class="btn btn-link btn-sm ofinder-text-primary p-0 mr-3 d-none d-md-inline"
          {{on "click" this.clearAllFilters}}
        >
          Cancella tutto
        </button>
      {{/if}}
      <i class="fa fa-chevron-down d-md-none"></i>
    </div>
  </div>

  {{!-- Contenuto collassabile (solo su mobile) --}}
  <div id="filterPanelContent" class="collapse d-md-block">
    <hr class="d-md-none my-3" />

    {{!-- Accordion container per sezioni interne --}}
    <div id="filterAccordion">
      {{!-- Geolocalizzazione --}}
      <div class="filter-section mb-3">
        <h6
          class="ofinder-text-sm font-weight-bold mb-3 text-uppercase d-md-block d-flex justify-content-between align-items-center"
          data-toggle="collapse"
          data-target="#collapseLocation"
          role="button"
          aria-expanded="true"
          aria-controls="collapseLocation"
        >
          <span>Posizione</span>
          <i class="fa fa-chevron-down d-md-none"></i>
        </h6>
        <div id="collapseLocation" class="collapse show" data-parent="#filterAccordion">
          {{!-- Nazione --}}
          <div class="form-group mb-3">
            <label class="ofinder-text-xs text-uppercase ofinder-text-muted mb-1">
              Nazione
            </label>
            <select
              class="form-control form-control-sm"
              {{on "change" this.selectCountry}}
            >
              {{#each this.countries as |country|}}
                <option
                  value={{country.id}}
                  selected={{eq this.selectedCountry country.id}}
                >
                  {{country.name}}
                </option>
              {{/each}}
            </select>
          </div>

          {{!-- Regione --}}
          <div class="form-group mb-3">
            <label class="ofinder-text-xs text-uppercase ofinder-text-muted mb-1">
              Regione
            </label>
            <select
              class="form-control form-control-sm"
              {{on "change" this.selectRegion}}
            >
              <option value="" selected={{not this.selectedRegion}}>--</option>
              {{#each this.regions as |region|}}
                <option
                  value={{region.id}}
                  selected={{eq this.selectedRegion region.id}}
                >
                  {{region.name}}
                </option>
              {{/each}}
            </select>
          </div>

          {{!-- Provincia --}}
          <div class="form-group mb-0">
            <label class="ofinder-text-xs text-uppercase ofinder-text-muted mb-1">
              Provincia
            </label>
            <select
              class="form-control form-control-sm"
              {{on "change" this.selectProvince}}
              disabled={{not this.selectedRegion}}
            >
              <option value="" selected={{not this.selectedProvince}}>--</option>
              {{#each this.availableProvinces as |province|}}
                <option
                  value={{province.id}}
                  selected={{eq this.selectedProvince province.id}}
                >
                  {{province.name}}
                </option>
              {{/each}}
            </select>
          </div>
        </div>
      </div>

      {{!-- Piattaforme --}}
      <div class="filter-section mb-3">
        <h6
          class="ofinder-text-sm font-weight-bold mb-3 text-uppercase d-md-block d-flex justify-content-between align-items-center"
          data-toggle="collapse"
          data-target="#collapsePlatforms"
          role="button"
          aria-expanded="false"
          aria-controls="collapsePlatforms"
        >
          <span>Piattaforme</span>
          <i class="fa fa-chevron-down d-md-none"></i>
        </h6>
        <div id="collapsePlatforms" class="collapse d-md-block" data-parent="#filterAccordion">
          {{#each this.platformFilters as |platform|}}
            <div class="custom-control custom-checkbox mb-2">
              <input
                type="checkbox"
                class="custom-control-input"
                id="platform-{{platform.id}}"
                checked={{this.isPlatformSelected platform.id}}
                {{on "change" (fn this.togglePlatform platform)}}
              />
              <label
                class="custom-control-label ofinder-text-sm"
                for="platform-{{platform.id}}"
              >
                <span class="platform-icon-badge mr-2">{{brand-icon platform.id size=14}}</span>
                {{platform.name}}
                <span class="ofinder-text-muted">({{platform.count}})</span>
              </label>
            </div>
          {{/each}}
        </div>
      </div>

      {{!-- Tipi di Contenuto --}}
      <div class="filter-section mb-3">
        <h6
          class="ofinder-text-sm font-weight-bold mb-3 text-uppercase d-md-block d-flex justify-content-between align-items-center"
          data-toggle="collapse"
          data-target="#collapseContentTypes"
          role="button"
          aria-expanded="false"
          aria-controls="collapseContentTypes"
        >
          <span>Tipi di Contenuto</span>
          <i class="fa fa-chevron-down d-md-none"></i>
        </h6>
        <div id="collapseContentTypes" class="collapse d-md-block" data-parent="#filterAccordion">
          {{#each this.contentTypeFilters as |contentType|}}
            <div class="custom-control custom-checkbox mb-2">
              <input
                type="checkbox"
                class="custom-control-input"
                id="contentType-{{contentType.id}}"
                checked={{this.isContentTypeSelected contentType.id}}
                {{on "change" (fn this.toggleContentType contentType)}}
              />
              <label
                class="custom-control-label ofinder-text-sm"
                for="contentType-{{contentType.id}}"
              >
                {{contentType.name}}
                <span class="ofinder-text-muted">({{contentType.count}})</span>
              </label>
            </div>
          {{/each}}
        </div>
      </div>

      {{!-- Range Slider Prezzo --}}
      <div class="filter-section mb-3">
        <h6
          class="ofinder-text-sm font-weight-bold mb-3 text-uppercase d-md-block d-flex justify-content-between align-items-center"
          data-toggle="collapse"
          data-target="#collapsePrice"
          role="button"
          aria-expanded="false"
          aria-controls="collapsePrice"
        >
          <span>
            Prezzo ($/mese)
            <span class="ofinder-text-primary">${{this.maxPrice}}</span>
          </span>
          <i class="fa fa-chevron-down d-md-none"></i>
        </h6>
        <div id="collapsePrice" class="collapse d-md-block" data-parent="#filterAccordion">
          <input
            type="range"
            class="custom-range"
            min="0"
            max="50"
            step="5"
            value={{this.maxPrice}}
            {{on "input" this.updatePriceFilter}}
          />
          <div
            class="d-flex justify-content-between ofinder-text-xs ofinder-text-muted mt-2"
          >
            <span>Free</span>
            <span>$50+</span>
          </div>
        </div>
      </div>

      {{!-- Rating --}}
      <div class="filter-section mb-3">
        <h6
          class="ofinder-text-sm font-weight-bold mb-3 text-uppercase d-md-block d-flex justify-content-between align-items-center"
          data-toggle="collapse"
          data-target="#collapseRating"
          role="button"
          aria-expanded="false"
          aria-controls="collapseRating"
        >
          <span>Rating Minimo</span>
          <i class="fa fa-chevron-down d-md-none"></i>
        </h6>
        <div id="collapseRating" class="collapse d-md-block" data-parent="#filterAccordion">
          {{#each this.ratingFilters as |rating|}}
            <div class="custom-control custom-radio mb-2">
              <input
                type="radio"
                class="custom-control-input"
                id="rating-{{rating.value}}"
                name="ratingFilter"
                checked={{eq this.selectedRating rating.value}}
                {{on "change" (fn this.selectRating rating.value)}}
              />
              <label
                class="custom-control-label ofinder-text-sm"
                for="rating-{{rating.value}}"
              >
                <RatingStars @rating={{rating.value}} @size="sm" />
                ({{rating.label}})
              </label>
            </div>
          {{/each}}
        </div>
      </div>

      {{!-- Stato --}}
      <div class="filter-section mb-3">
        <h6
          class="ofinder-text-sm font-weight-bold mb-3 text-uppercase d-md-block d-flex justify-content-between align-items-center"
          data-toggle="collapse"
          data-target="#collapseStatus"
          role="button"
          aria-expanded="false"
          aria-controls="collapseStatus"
        >
          <span>Stato</span>
          <i class="fa fa-chevron-down d-md-none"></i>
        </h6>
        <div id="collapseStatus" class="collapse d-md-block" data-parent="#filterAccordion">
          <div class="custom-control custom-checkbox mb-2">
            <input
              type="checkbox"
              class="custom-control-input"
              id="filter-verified"
              checked={{this.onlyVerified}}
              {{on "change" this.toggleVerified}}
            />
            <label class="custom-control-label ofinder-text-sm" for="filter-verified">
              <span class="ofinder-badge-verified ofinder-rounded-sm">âœ“</span>
              Solo Verificati
            </label>
          </div>

          <div class="custom-control custom-checkbox mb-2">
            <input
              type="checkbox"
              class="custom-control-input"
              id="filter-new"
              checked={{this.onlyNew}}
              {{on "change" this.toggleNew}}
            />
            <label class="custom-control-label ofinder-text-sm" for="filter-new">
              <span class="ofinder-badge-new ofinder-rounded-sm">New</span>
              Nuovi (ultimi 30gg)
            </label>
          </div>

          <div class="custom-control custom-checkbox mb-2">
            <input
              type="checkbox"
              class="custom-control-input"
              id="filter-active"
              checked={{this.onlyActiveToday}}
              {{on "change" this.toggleActiveToday}}
            />
            <label class="custom-control-label ofinder-text-sm" for="filter-active">
              <i class="fa fa-signal ofinder-text-success"></i>
              Attivi oggi
            </label>
          </div>
        </div>
      </div>
    </div>

    {{!-- Bottoni Azione --}}
    <div class="filter-panel-footer mt-4">
      <button
        type="button"
        class="btn btn-block btn-ofinder-primary mb-2"
        {{on "click" this.applyFilters}}
      >
        Applica Filtri
        {{#if this.activeFiltersCount}}
          ({{this.activeFiltersCount}})
        {{/if}}
      </button>

      {{#if this.hasActiveFilters}}
        <button
          type="button"
          class="btn btn-block btn-outline-secondary"
          {{on "click" this.clearAllFilters}}
        >
          Cancella tutto
        </button>
      {{/if}}
    </div>
  </div>
</div>

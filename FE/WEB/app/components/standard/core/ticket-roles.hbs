<div class="ticket-roles p-3" {{did-update (perform this.start) @lastRefresh}}>
  {{#if (or (eq this.available 'waiting') this.start.isRunning)}}
    <Standard::LoadingSpinner @icon='1' @msg="Caricamento in corso, attendere prego..." @msgKey="" @style="3" class="alert-info"/>
  {{else if (eq this.available 'unavailable')}}
    <Standard::LoadingSpinner @icon="" @style="3" class="alert-danger">
      Si Ã¨ verificato un errore. <a href="#" class="ml-2" {{on 'click' (perform this.start)}}>Riprova.</a>
    </Standard::LoadingSpinner>
  {{else if (eq this.available 'available')}}
    <div class="row m-0 mb-4">
      <div class="col-12 text-right">
        <button class="btn btn-sm btn-hover-shine btn-primary mb-2 mr-1" type="button" data-toggle="collapse" href="#ticket-roles-add">
          <i class="fa fa-plus-circle mr-2"></i>
          AGGIUNGI RUOLO
        </button>
        <button class="btn btn-sm btn-hover-shine btn-secondary btn-icon-only mb-2" type="button" data-toggle="collapse" href="#ticket-roles-info">
          <i class="fa fa-info-circle"></i>
        </button>
      </div>

      <div class="col-12 mb-3 collapse" id="ticket-roles-info">
        <div class="alert alert-secondary fade show mb-3" role="alert">
          <strong>INFO:</strong> in questa pagina puoi definire i Ruoli che meglio identificano gli operatori della tua azienda.
        </div>
      </div>

      <div class="col-12 mb-3 collapse" id="ticket-roles-add">
        <div class="main-card mb-3 card">
          <div class="card-body">
            <div class="row">
              {{#if this.auth.license.canUseRoles}}
                <div class="col-12 col-md-10 mb-3">
                  <div class="position-relative form-group">
                    <label for="ticket-area-name">Nome del Ruolo</label>
                    <input {{on 'input' this.setNewName}} value={{this.newName}} id="ticket-area-name" type="text" class="form-control">
                  </div>
                </div>

                <div class="col-12 col-md-2 text-center mb-3">
                  <button {{on 'click' (perform this.save)}} class="btn btn-hover-shine btn-success m-auto" type="button">
                    <i class="fa {{if this.save.isRunning 'fa-spinner fa-spin' 'fa-save'}} mr-2"></i>
                    SALVA
                  </button>
                </div>
              {{else}}
                <div class="col-12">
                  <small class="form-text text-danger">La tua Licenza non consente la gestione dei Ruoli! <LinkTo @route="ticket-license" class="text-danger"><u>Espandi la tua licenza!</u></LinkTo></small>
                </div>
              {{/if}}
            </div>
          </div>
        </div>
      </div>

      <div class="col-md-12">
        <div class="card main-card mb-3">
          <div class="card-header">ELENCO DEI RUOLI RELATIVI AL TICKETING</div>
          <div class="card-body p-0">
            {{#if (eq (length this.ticketRoles) 0)}}
              <p class="m-4 text-danger">
                <em>
                  Non sono presenti Ruoli!
                </em>
              </p>
            {{else}}
              <ul class="list-group">
                {{#each this.ticketRoles as | role |}}
                  <li class="list-group-item">
                    <div class="widget-content p-0">
                      <div class="widget-content-wrapper">
                        <div class="widget-content-left pl-0 col-md-10">
                          {{#if (eq role.id this.editingGuid)}}
                            <div class="widget-heading">
                              <em>Modifica ruolo "{{role.name}}"</em>
                            </div>
                            <div class="widget-subheading">
                              <div class="row">
                                <div class="col-md-8">
                                  {{!-- template-lint-disable require-input-label --}}
                                  Nome:<br /><input {{on 'input' this.updateName}} value={{this.editRecord.name}} type="text" class="form-control form-control-sm mb-1">
                                </div>
                              </div>
                            </div>
                          {{else}}
                            <div class="widget-heading">{{sanitize-content role.name}}
                              {{#if (eq (length role.userRoles) 0)}}
                                <small class="text-warning ml-3">(0 operatori assegnati)</small>
                              {{else}}
                                <small class="opacity-5 ml-3">({{length role.userRoles}} operatori assegnati)</small>
                              {{/if}}
                            </div>
                          {{/if}}
                        </div>
                        <div class="widget-content-right col-md-2 pr-0 text-right">
                          {{#if (eq this.editingGuid '')}}
                            <div role="group" class="btn-group btn-group-sm">
                              {{!-- edit button --}}
                              <button {{on 'click' (fn this.modifyRecord role)}} type="button" class="btn btn-warning btn-shadow btn-hover-shine btn-icon-only">
                                <i class="fa fa-edit"></i>
                              </button>
                              {{!-- delete button --}}
                              <button {{on 'click' (fn this.deleteArea role)}} type="button" class="btn btn-danger btn-shadow btn-hover-shine btn-icon-only">
                                <i class="fa fa-trash"></i>
                              </button>
                            </div>
                          {{else if (eq this.editingGuid role.id)}}
                            <div role="group" class="btn-group btn-group-sm">
                              {{!-- undo button --}}
                              <button {{on 'click' (fn this.restoreRecord role)}} type="button" class="btn btn-success btn-shadow btn-hover-shine btn-icon-only">
                                <i class="fa fa-undo"></i>
                              </button>
                              {{!-- save button --}}
                              <button {{on 'click' (fn this.saveUpdatedRecord role)}} type="button" class="btn btn-warning btn-shadow btn-hover-shine btn-icon-only">
                                <i class="fa fa-save"></i>
                              </button>
                            </div>
                          {{/if}}
                        </div>
                      </div>
                    </div>
                  </li>
                {{/each}}
              </ul>
            {{/if}}
          </div>
        </div>
    </div>





    </div>
  {{/if}}
</div>
{{yield}}